<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dashboard</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 16px; color: #222; }
      input, button { padding: 10px; margin: 6px 0; width: 100%; box-sizing: border-box; }
      table { border-collapse: collapse; width: 100%; margin-top: 12px; }
      th, td { border: 1px solid #ddd; padding: 8px; font-size: 12px; }
      th { background: #f5f5f5; text-align: left; }
      .card { border: 1px solid #ddd; padding: 16px; margin-bottom: 16px; border-radius: 8px; background: #fff; }
      .row { display: flex; gap: 16px; flex-wrap: wrap; }
      .row > div { flex: 1; }
      .small { font-size: 12px; color: #666; }
      .error { color: #b00020; }
      .hidden { display: none; }
      .table-wrap { width: 100%; overflow-x: auto; }

      @media (max-width: 640px) {
        body { margin: 12px; }
        th, td { font-size: 11px; padding: 6px; }
        .row { flex-direction: column; gap: 12px; }
        .card { padding: 12px; }
      }
    </style>
    <script src="https://esm.sh/@supabase/supabase-js@2"></script>
    <script defer src="app.js"></script>
  </head>
  <body>
    <div id="loginCard" class="card">
      <div>
        <label>Email</label>
        <input id="email" type="email" placeholder="user@example.com" />
      </div>
      <div>
        <label>Password</label>
        <input id="password" type="password" placeholder="••••••••" />
      </div>
      <button id="btnLogin">로그인</button>
      <div class="small" id="loginStatus"></div>
      <div id="err" class="error small"></div>
    </div>

    <div id="viewer" class="hidden">
      <div class="row">
        <div class="card">
          <div class="row">
            <div style="flex:1">
              <button id="btnLoadRuns">프로그램 실행 로그 조회</button>
            </div>
            <div style="flex:1">
              <button id="btnLoadStatsDaily">일별 통계 조회</button>
            </div>
            <div style="flex:1">
              <button id="btnLoadStatsMonthly">월별 통계 조회</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="table-wrap">
          <table id="tblRuns">
            <thead>
              <tr>
                <th>username</th>
                <th>occurred_at_kst</th>
                <th>ip_address</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="card">
        <div class="table-wrap">
          <table id="tblStatsDaily">
            <thead>
              <tr>
                <th>username</th>
                <th>day_kst</th>
                <th>dm_count</th>
                <th>invite_success</th>
                <th>invite_failed</th>
                <th>contact_total</th>
                <th>contact_success</th>
                <th>contact_failed</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="card">
        <div class="table-wrap">
          <table id="tblStatsMonthly">
            <thead>
              <tr>
                <th>year</th>
                <th>month</th>
                <th>username</th>
                <th>dm_count</th>
                <th>invite_success</th>
                <th>invite_failed</th>
                <th>contact_total</th>
                <th>contact_success</th>
                <th>contact_failed</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
  </html>


